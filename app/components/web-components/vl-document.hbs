<div
  class={{if this.piece.aboutToDelete "vlc-document--deleted-state"}}
  {{did-update (perform this.loadPieceRelatedData) @piece}}
>
  <div class="vlc-document-card-item" data-test-vl-document-piece>
    <div class="vlc-document-card-item__title">
      <h6 class="auk-h4">
        {{#if (not this.file)}}
          <EmberTooltip @side="bottom" @tooltipClass="tooltip-custom">
            {{t "document-not-consultable"}}
          </EmberTooltip>
        {{/if}}
        {{this.piece.name}}
      </h6>
      {{#unless this.loadPieceRelatedData.isRunning}}
        <AccessLevelPill
          @accessLevel={{this.accessLevel}}
          @confidential={{this.piece.confidential}}
          @onChangeAccessLevel={{this.changeAccessLevel}}
          @onConfirmChangeAccessLevel={{this.saveAccessLevel}}
          @onCancelChangeAccessLevel={{this.reloadAccessLevel}}
          @onChangeConfidentiality={{this.changeConfidentiality}}
        />
      {{/unless}}
      {{#if this.file}}
        <button
          type="button"
          class="auk-button auk-button--borderless auk-button--icon"
          {{on "click" this.showPieceViewer}}
        >
          <span class="auk-button__content">
            <div class="auk-icon auk-icon--default">
              <i class="ki ki-book"></i>
            </div>
            <div class="auk-u-sr-only">
              {{t "view-document-details"}}
            </div>
          </span>
        </button>
        <a
          class="auk-button auk-button--borderless auk-button--icon"
          href={{await this.piece.downloadFileLink}}
          {{!-- download --}}
          {{! 'download' attribute doesn't specify a filename, as this gets overruled by
          the filename received in the "Content-Disposition HTTP header" }}
        >
          <span class="auk-button__content">
            <div class="auk-icon auk-icon--default">
              <i class="ki ki-download"></i>
            </div>
            <div class="auk-u-sr-only">
              {{t "download"}}
            </div>
          </span>
        </a>
      {{/if}}

      {{#if (and this.currentSession.isEditor @enableDelete)}}
        <button
          type="button"
          class="auk-button auk-button--warning-borderless auk-button--icon"
          data-test-vl-document-delete-piece
          {{on "click" (fn this.deletePiece piece)}}
        >
          <span class="auk-button__content">
            <div class="auk-icon auk-icon--default">
              <i class="ki ki-delete"></i>
            </div>
            <div class="auk-u-sr-only">
              {{t "delete"}}
            </div>
          </span>
        </button>
      {{/if}}
    </div>
    {{#if this.currentSession.isEditor}}
      <div class="vlc-document-card-item__meta">
        {{t "uploaded-at"}}
        {{moment-format this.piece.created "DD.MM.YYYY"}}
        {{t "at"}}
        {{moment-format this.piece.created "HH:mm"}}
      </div>
    {{/if}}
    <div class="vlc-document-card-item__icon">
      <Auk::Icon @name="timeline" @size="large" />
    </div>
    {{#if this.isVerifyingDelete}}
      <WebComponents::VlModalVerify
        @title={{t "document-delete"}}
        @message={{t "delete-document-message"}}
        @cancel={{this.cancelDelete}}
        @verify={{this.confirmDelete}}
      />
    {{/if}}
  </div>
</div>