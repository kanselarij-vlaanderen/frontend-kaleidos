<Auk::Modal>
  <Auk::Modal::Header
    @title={{if
      this.isViaCouncilOfMinisters
      (t "publications-new-title-via-council-of-ministers")
      (t "publications-new-title-not-via-council-of-ministers")
    }}
    @onClose={{@onCancel}}
    @closeDisabled={{this.save.isRunning}}
  />
  <Auk::Modal::Body>
    <Utils::LoadableContent
      @isLoading={{this.save.isRunning}}
      @reserveSpace={{true}}
    >
      {{#unless this.isViaCouncilOfMinisters}}
        <Auk::Alert
          data-test-new-publication-alert-info
          @icon="circle-info"
          @message={{t "publications-new-warning-message"}}
        />
      {{/unless}}
      <div class="auk-form-group-layout auk-form-group-layout--standard">
        <div class="auk-form-group">
          <Auk::Label
            for="publicationNumberInput"
            @required={{true}}
            @error={{not this.isPublicationNumberValid}}
          >
            {{t "publication-number"}}
          </Auk::Label>
          <div class="auk-u-mb">
            <Auk::Input
              data-test-new-publication-number
              @type="number"
              id="publicationNumberInput"
              value={{this.number}}
              @error={{not this.isPublicationNumberValid}}
              disabled={{this.initPublicationNumber.isRunning}}
              {{on "input" (perform this.setPublicationNumber)}}
            />
            <Auk::Input
              data-test-new-publication-suffix
              id="publicationSuffixInput"
              @width="xsmall"
              value={{this.suffix}}
              @error={{not this.isPublicationNumberValid}}
              {{on "input" (perform this.setPublicationNumberSuffix)}}
            />
            <Utils::Generic::TooltipHelp class="auk-u-mx">
              {{t "publication-flow-publication-number-help"}}
            </Utils::Generic::TooltipHelp>
          </div>
          {{#if this.publicationNumberErrorTranslationKey}}
            <Auk::FormHelpText
              @text={{t this.publicationNumberErrorTranslationKey}}
              @skin="danger"
              @icon="alert-triangle"
            />
          {{/if}}
        </div>
        <div class="auk-form-group">
          <Auk::Label
            for="shortTitleInput"
            @required={{true}}
            @error={{this.isShownShortTitleError}}
          >
            {{t "name-subcase"}}
          </Auk::Label>
          <Auk::Textarea
            id="shortTitleInput"
            @rows="2"
            @value={{mut this.shortTitle}}
            @error={{this.isShownShortTitleError}}
            data-test-new-publication-short-title
            {{on "focusout" this.enableErrorOnShortTitle}}
          />
          {{#if this.isShownShortTitleError}}
            <Auk::FormHelpText
              @text={{t "input-error-message"}}
              @skin="danger"
              @icon="alert-triangle"
            />
          {{/if}}
        </div>
        <div class="auk-form-group">
          <Auk::Label for="longTitleInput">
            {{t "title-subcase"}}
          </Auk::Label>
          <Auk::Textarea
            id="longTitleInput"
            @rows="4"
            @value={{mut this.longTitle}}
            data-test-new-publication-long-title
          />
        </div>
        <div class="auk-o-grid">
          <div class="auk-o-grid-col-1 auk-form-group">
            <Auk::Label>
              {{t "decision-date"}}
            </Auk::Label>
            {{#if this.isViaCouncilOfMinisters}}
              <span class="auk-u-text-muted">
                {{moment-format this.decisionDate "DD-MM-YYYY"}}
              </span>
            {{else}}
              <Auk::Datepicker
                @date={{this.decisionDate}}
                @onChange={{this.setDecisionDate}}
              />
            {{/if}}
          </div>
          <div class="auk-o-grid-col-1 auk-form-group">
            <Auk::Label>
              {{t "publication-flow-opening-date"}}
            </Auk::Label>
            {{#if this.isViaCouncilOfMinisters}}
              <span class="auk-u-text-muted">
                {{moment-format this.openingDate "DD-MM-YYYY"}}
              </span>
            {{else}}
              <Auk::Datepicker
                @date={{this.openingDate}}
                @onChange={{this.setOpeningDate}}
              />
            {{/if}}
          </div>
          <div class="auk-o-grid-col-1 auk-form-group">
            <Auk::Label>
              {{t "publication-flow-publication-due-date"}}
            </Auk::Label>
            <Auk::Datepicker
              @date={{this.publicationDueDate}}
              @onChange={{this.setPublicationDueDate}}
            />
          </div>
        </div>
      </div>
    </Utils::LoadableContent>
  </Auk::Modal::Body>
  <Auk::Modal::Footer @custom={{true}}>
    <Auk::Toolbar @size="large">
      <Auk::Toolbar::Group @position="left">
        <Auk::Toolbar::Item>
          <Auk::ButtonLink
            data-test-new-publication-cancel
            @disabled={{this.save.isRunning}}
            {{on "click" @onCancel}}
          >
            {{t "cancel"}}
          </Auk::ButtonLink>
        </Auk::Toolbar::Item>
      </Auk::Toolbar::Group>
      <Auk::Toolbar::Group @position="right">
        <Auk::Toolbar::Item>
          <Auk::Button
            @skin="primary"
            @loading={{this.save.isRunning}}
            @disabled={{or (not this.isValid) this.save.isRunning}}
            data-test-new-publication-create
            {{on "click" (perform this.save)}}
          >
            {{t "publications-new-button-text"}}
          </Auk::Button>
        </Auk::Toolbar::Item>
      </Auk::Toolbar::Group>
    </Auk::Toolbar>
  </Auk::Modal::Footer>
</Auk::Modal>