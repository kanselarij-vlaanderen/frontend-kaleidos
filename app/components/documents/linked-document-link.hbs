<div class="vlc-document-card auk-u-mb-2" data-test-linked-document-link-card>
  <div class="vlc-document-card__summary">
    <div class="auk-u-mr-3">
      <Auk::Badge @icon="document" @size="large"/>
    </div>
    <div class="vlc-document-card__content">
      <Auk::Toolbar @auto={{true}}>
        <Auk::Toolbar::Group @position="left">
          <Auk::Toolbar::Item>
            <p class="vlc-subline au-u-medium au-u-muted" data-test-linked-document-link-type-label>
              {{@documentContainer.type.label}}
            </p>
            <h6 class="auk-h4">
              <LinkTo @route="document" @model={{this.lastPiece.id}} target="_blank">
                {{this.lastPiece.name}}
              </LinkTo>
            </h6>
          </Auk::Toolbar::Item>
        </Auk::Toolbar::Group>
        <div class="vlc-document-card-toolbar__right">
          <Auk::Toolbar::Item>
            {{#if this.lastPiece}}
              <AccessLevelPill
                @accessLevel={{this.accessLevel}}
                @onChangeAccessLevel={{this.changeAccessLevel}}
                @onConfirmChangeAccessLevel={{this.saveAccessLevel}}
                @onCancelChangeAccessLevel={{this.reloadAccessLevel}}
              />
            {{/if}}
          </Auk::Toolbar::Item>
          <Auk::Toolbar::Item>
            {{#if this.currentSession.isEditor}}
              <Auk::Button
                @skin="danger-borderless"
                @layout="icon-only"
                @icon="link-broken"
                {{on "click" this.deletePieceLink}}
              />
            {{/if}}
          </Auk::Toolbar::Item>
        </div>
      </Auk::Toolbar>
      {{#if this.lastPiece.created}}
        <div class="vlc-document-card-content__meta auk-u-mt-2">
          {{! no piece.created in legacy data }}
          {{! TODO: when created date is absent, the layout seems irregular
                this will be addressed with new document card styling }}
          <div>
            {{t "uploaded-at"}}
            {{moment-format this.lastPiece.created}}
            {{t "at"}}
            {{moment-format this.lastPiece.created "HH:mm"}}
          </div>
        </div>
      {{/if}}
    </div>
  </div>
    {{#if this.reverseSortedPieceHistory.length}}
      <div class="vlc-document-card-versions">
        <Auk::Accordion>
          <Auk::Accordion::Item
            @title={{t "previous-versions"}}
            data-test-linked-document-link-version-history
          >
            {{#each this.reverseSortedPieceHistory as |piece|}}
              <WebComponents::VlDocument
                @piece={{piece}}
                @didUpdateAccessLevel={{perform this.loadData}}
              />
            {{/each}}
          </Auk::Accordion::Item>
        </Auk::Accordion>
      </div>
  {{/if}}
</div>

{{#if this.isOpenVerifyDeleteModal}}
  <WebComponents::VlModalVerify
    @title={{t "document-unlink"}}
    @message={{t "unlink-document-message"}}
    @cancel={{this.cancelDeletePieceLink}}
    @verify={{this.verifyDeletePieceLink}}
    @verifyButtonText={{t "unlink"}} />
{{/if}}