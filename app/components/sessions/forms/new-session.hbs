{{! TODO: octane-refactor }}
{{! template-lint-disable no-action }}
<Auk::Modal::Body>
  <Utils::KindSelector
    data-test-new-session-kind={{true}}
    @kind={{this.kind}}
    @setAction={{action "setKind"}}
  />
  {{#if this.isAnnexMeeting}}
    <div class="auk-u-mb-2">
      <div class="auk-form-group">
        <Auk::Label>{{t "related-main-meeting-field-label"}}</Auk::Label>
        <Utils::ModelSelector
          data-test-new-session-related-main-meeting
          @modelName="meeting"
          @searchField="numberRepresentation"
          @propertyToShow="label"
          @sortField="-planned-start"
          @selectedItems={{this.selectedMainMeeting}}
          @selectModel={{action "selectMainMeeting"}}
        />
      </div>
    </div>
  {{else}}
    <div class="auk-u-mb-2">
      <div class="auk-form-group" data-test-new-session-datepicker>
        <Auk::Label>{{t "start-date"}}</Auk::Label>
        <WebComponents::VlDatepicker
          @enableTime={{true}}
          @defaultHour={{10}}
          @defaultMinute={{0}}
          @dateChanged={{action "selectStartDate"}}
        />
      </div>
    </div>
  {{/if}}
  <div class="auk-u-mb-2">
    <div class="auk-form-group">
      <Auk::Label for="meetingNumberInput">{{t "meeting-number"}}</Auk::Label>
      <div class="auk-o-flex">
        {{#unless this.isAnnexMeeting}}
          <Auk::Input
            data-test-new-session-meeting-number={{true}}
            @type="number"
            @value={{this.meetingNumber}}
            id="meetingNumberInput"
            class="auk-input--w-medium auk-u-mr-2"
            {{on
              "change"
              (action "meetingNumberChangedAction" this.meetingNumber)
            }}
            {{on
              "keyup"
              (action "meetingNumberChangedAction" this.meetingNumber)
            }}
          />
        {{/unless}}
        <div class="auk-o-flex__item">
          <div
            data-test-new-session-number-representation-view
            class="auk-u-text-condensed-line-height"
          >
            {{this.formattedMeetingIdentifier}}
          </div>
          <Auk::ButtonLink
            data-test-new-session-number-representation-edit
            {{action "editFormattedMeetingIdentifier"}}
          >
            <small>{{t "edit"}}</small>
          </Auk::ButtonLink>
        </div>
      </div>
    </div>
    {{#if this.isEditingFormattedMeetingIdentifier}}
      <div class="auk-o-flex">
        <Auk::Input
          @width="medium"
          @value={{this.formattedMeetingIdentifier}}
          class="auk-u-mr-2"
          data-test-new-session-number-representation-input={{true}}
        />
        <WebComponents::VlSaveButton
          data-test-new-session-number-representation-save={{true}}
          @text={{t "save"}}
          @saveAction={{action "saveAction"}}
        />
      </div>
    {{/if}}
  </div>
  {{#unless this.isAnnexMeeting}}
    <div class="auk-u-mb-2">
      <div class="auk-form-group">
        <Auk::Label>{{t "meeting-location"}}</Auk::Label>
        <Auk::Input
          @block={{true}}
          @value={{this.extraInfo}}
          data-test-new-session-meeting-location={{true}}
        />
      </div>
    </div>
  {{/unless}}
</Auk::Modal::Body>
<WebComponents::VlModalFooter
  @isLoading={{this.isLoading}}
  @cancelButtonText={{t "cancel"}}
  @saveButtonText={{t "add"}}
  @cancelAction={{action "cancelForm"}}
  @saveAction={{action "createNewSession"}}
/>