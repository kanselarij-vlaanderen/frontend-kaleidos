<Auk::Navbar @skin="gray-100" @auto={{true}}>
  <Auk::Toolbar>
    <Auk::Toolbar::Group @position="left">
      <Auk::Toolbar::Item>
          {{!-- <div class="auk-o-flex auk-o-flex--vertical-center">
            <h4 class="auk-toolbar-complex__title auk-u-text-capitalize">{{@subcase.shortTitle}}</h4>
          </div> --}}
        <Subcases::SubcaseDetailNav @currentRoute={{@currentRoute}} />
      </Auk::Toolbar::Item>
    </Auk::Toolbar::Group>
    <Auk::Toolbar::Group @position="right">
      {{#if (user-may "manage-agendaitems")}}
        {{!-- {{#if (not-eq @currentRoute 'cases.case.subcases-demo.subcase-demo.publication')}}
        <Auk::Toolbar::Item>
          {{#if (or this.loadData.isRunning this.isLoading)}}
            <div class="auk-loader" role="alert" aria-busy="true"></div>
          {{else}}
            <AuDropdown
              data-test-subcase-header-show-proposed-agendas={{true}}
              @skin="primary"
              @title={{t "propose-for-agenda"}}
              @alignment="right"
            >
              {{#each this.meetings as |meeting|}}
                <AuButton
                  data-test-subcase-header-propose-for-agenda
                  @skin="link"
                  {{on "click" (perform this.proposeForAgenda meeting)}}
                  role="menuitem"
                >
                  {{t "agenda-for"}}
                  {{date-phrase meeting.plannedStart}}
                  {{concat " - " meeting.numberRepresentation}}
                </AuButton>
              {{/each}}
              {{#if this.meetings}}
                <AuHr />
              {{/if}}
              <AuButton
                @skin="link"
                {{on "click" this.proposeForOtherAgenda}}
                role="menuitem"
              >
                {{t "other-agenda"}}
              </AuButton>
            </AuDropdown>
          {{/if}}
        </Auk::Toolbar::Item>
        {{/if}} --}}
        {{#if (not (or (eq @currentRoute 'cases.case.subcases-demo.subcase-demo.vp') (eq @currentRoute 'cases.case.subcases-demo.subcase-demo.publication')))}}
        <Auk::Toolbar::Item>
          {{#if @documents}}
            <AuDropdown
              @skin="primary"
              @title="Acties"
              @alignment="right"
            >
              <AuButton
                @skin="link"
                {{on "click" this.acceptDocuments}}
                role="menuitem"
              >
                Aanvaard nieuwe documenten
              </AuButton>
                <AuHr />
              <AuButton
                @skin="link"
                @alert={{true}}
                {{on "click" this.revert}}
                role="menuitem"
              >
                Stuur terug naar indiener
              </AuButton>
            </AuDropdown>
          {{else if @submission}}
          <AuDropdown
              @skin="primary"
              @title="Acties"
              @alignment="right"
            >
            <AuButton
              @skin="link"
              {{on "click" this.triggerAgendaSubcaseDialog}}
              role="menuitem"
            >
              Maak procedurestap en agendeer
            </AuButton>
              <AuHr />
            <AuButton
              @skin="link"
              @alert={{true}}
              {{on "click" this.revert}}
              role="menuitem"
            >
              Stuur terug naar indiener
            </AuButton>
          </AuDropdown>
          {{else}}
          <AuDropdown
            data-test-subcase-header-actions-dropdown={{true}}
            @skin="secondary"
            @title={{t "actions"}}
            @alignment="right"
          >
            {{#if (not-eq @currentRoute 'cases.case.subcases-demo.subcase-demo.publication')}}
            <AuButton
              data-test-subcase-header-action-delete-subcase
              @skin="link"
              @alert={{true}}
              {{on "click" (fn this.requestDeleteSubcase @subcase)}}
              role="menuitem"
            >
              {{t "delete-subcase"}}
            </AuButton>
            {{/if}}
            <AuButton
              @skin="link"
              @alert={{true}}
              {{on "click" this.revertStep}}
              role="menuitem"
            >
              Procedurestap verwijderen en terug naar indiener sturen
            </AuButton>
            <AuButton
              data-test-subcase-header-action-move-subcase
              @skin="link"
              {{on "click" this.triggerMoveSubcaseDialog}}
              role="menuitem"
            >
              {{t "move-subcase"}}
            </AuButton>
            {{#if (not-eq @currentRoute 'cases.case.subcases-demo.subcase-demo.publication')}}
            <AuButton
              @skin="link"
              {{on "click" this.triggerAgendaSubcaseDialog}}
              role="menuitem"
            >
              Indienen voor agendering
            </AuButton>
            {{/if}}
          </AuDropdown>
          {{/if}}
        </Auk::Toolbar::Item>
        {{/if}}
      {{/if}}
      {{#if @kabinet}}
      <Auk::Toolbar::Item>
        <AuLink
          @skin="button-secondary"
          @icon="add"
          role="menuitem"
          @route="cases.case.subcases-documents"
          @model={{@model.id}}
        >
          Dien nieuwe documenten in
        </AuLink>
      </Auk::Toolbar::Item>
      {{/if}}
      {{#if @edit}} 
      <Auk::Toolbar::Item>
        <AuButton
          @skin="secondary"
          role="menuitem"
          {{on "click" this.resubmit}}
        >
          Dien opnieuw in
        </AuButton>
      </Auk::Toolbar::Item>
      {{/if}}
    </Auk::Toolbar::Group>
  </Auk::Toolbar>
</Auk::Navbar>

<ConfirmationModal
  @modalOpen={{this.promptDeleteCase}}
  @title={{t "delete-empty-case"}}
  @message={{t "delete-empty-case-confirmation" case=this.caseToDelete.shortTitle}}
  @onConfirm={{perform this.deleteCase this.caseToDelete}}
  @onCancel={{this.cancelDeleteCase}}
  @confirmMessage={{t "delete"}}
  @alert={{true}}
  @loading={{this.deleteCase.isRunning}}
/>

<AuModal
  @modalOpen={{this.isAssigningToOtherCase}}
  @closeModal={{this.cancel}}
  @padding="none"
>
  <:title>
    {{t "move-subcase-to-other-case"}}
  </:title>
  <:body>
    <Utils::CaseSearch @onSelect={{this.moveSubcase}} />
  </:body>
</AuModal>

{{#if this.isAssigningToOtherAgenda}}
  <Subcases::ProposableMeetings
    @onProposeForMeeting={{perform this.proposeForAgenda}}
    @onCancel={{this.cancel}}
  />
{{/if}}

<ConfirmationModal
  @modalOpen={{this.isDeletingSubcase}}
  @title={{t "delete-subcase"}}
  @message={{t "delete-subcase-confirmation"}}
  @onConfirm={{this.deleteSubcase}}
  @onCancel={{this.cancel}}
  @confirmMessage={{t "delete"}}
  @alert={{true}}
  @loading={{this.isLoading}}
/>

{{#if this.showAgendaModal}}
<Auk::Modal>
  <Auk::Modal::Header @title="Agendering" @onClose={{this.triggerAgendaSubcaseDialog}} />
  <Auk::Modal::Body>
    <div>
      <div class="auk-form-group">
        <Auk::Label for="new-subcase-ok">Formeel ok</Auk::Label>
        <AuToggleSwitch
          id="new-subcase-ok"
        />
      </div>
      <div class="auk-form-group">
        <Auk::Label for="remarks">Interne opmerkingen</Auk::Label>
        <Auk::Textarea
          @rows="4"
          @value=""
          id="remarks"
        />
      </div>
      <AuHr />
      <table class="auk-table auk-table--striped">
        <thead>
          <tr>
            <th class="auk-table__col--1"></th>
            <Utils::ThSortable
              @field="created"
              @label="Datum aangemaakt"
            />
            <Utils::ThSortable
              @field="short-title"
              @label="Titel"
            />
          </tr>
        </thead>
        <tbody class="auk-table--clickable-rows">
          {{#each this.agendas as |agenda|}}
            <tr>
              <td class="auk-table__col--1">
                <AuRadio @name="agendas" {{on 'click' this.toggleAgenda }} />
              </td>
              <td class="auk-table__col--3">
                {{agenda.created}}
              </td>
              <td class="auk-table__col--8">
                <strong>{{agenda.title}}</strong>
                <AuPill @skin="ongoing" @draft={{true}}>{{agenda.letter}}</AuPill>
              </td>
            </tr>
          {{/each}}
        </tbody>
      </table>
    </div>
  </Auk::Modal::Body>
  <Auk::Modal::Footer
    @onCancel={{this.triggerAgendaSubcaseDialog}}
  >
    <AuButton
      @skin="primary"
      @disabled={{if (eq this.hasAgenda false) true}}
      {{on "click" this.triggerAgendaSubcaseDialog}}
    >
      Plaats op agenda
    </AuButton>
  </Auk::Modal::Footer>
</Auk::Modal>
{{/if}}