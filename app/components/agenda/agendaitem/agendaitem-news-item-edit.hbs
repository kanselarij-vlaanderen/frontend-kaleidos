<Auk::Panel>
  <Auk::Panel::Header>
    <Auk::Toolbar>
      <Auk::Toolbar::Group @position="left">
        <Auk::Toolbar::Item>
          <AuHeading @level="4" @skin="5" data-test-agendaitem-news-item-title>
            {{@newsletterInfo.title}}
          </AuHeading>
        </Auk::Toolbar::Item>
      </Auk::Toolbar::Group>
      <Auk::Toolbar::Group @position="right">
        <Auk::Toolbar::Item>
          {{#if (not (is-pending @agendaitem.notaOrVisienota))}}
            {{#if (not (await @agendaitem.notaOrVisienota))}}
              <AuButton
                data-test-newsletter-edit-item-no-nota
                @skin="naked"
                @icon="document"
                @iconAlignment="left"
                @disabled={{true}}
                class="au-u-padding-right-none"
              >
                {{t "no-nota"}}
              </AuButton>
            {{else}}
              <AuButton
                data-test-newsletter-edit-item-nota
                @skin="naked"
                @icon="document"
                @iconAlginment="left"
                class="au-u-padding-right-none"
                {{on "click" this.openDocument}}
              >
                {{t "open-note"}}
              </AuButton>
            {{/if}}
          {{else}}
            <div class="auk-loader" role="alert" aria-busy="true">
              <EmberTooltip @side="bottom" @tooltipClass="auk-tooltip">
                {{t "nota-loading-text"}}
              </EmberTooltip>
            </div>
          {{/if}}
        </Auk::Toolbar::Item>
      </Auk::Toolbar::Group>
    </Auk::Toolbar>
  </Auk::Panel::Header>
  <Auk::Panel::Body class="au-u-background-gray-100">
    <div class="auk-form-group">
      <AuLabel>{{t "title"}}</AuLabel>
      <p data-test-newsletter-edit-item-long-title>
        {{@agendaitem.title}}
      </p>
    </div>
    <div class="auk-form-group">
      <AuLabel>{{t "short-title"}}</AuLabel>
      <AuInput
        data-test-newsletter-edit-item-short-title
        @width="block"
        @value={{@newsletterInfo.title}}
      />
    </div>
    <div class="auk-form-group">
      <AuLabel>{{t "mandatee-proposal"}}</AuLabel>
      <p
        data-test-newsletter-edit-item-mandatee-proposal
      >
        {{#if (await @newsletterInfo.newsletterProposal)}}
          {{await @newsletterInfo.newsletterProposal}}
        {{else}}
          {{t "not-applicable"}}
        {{/if}}
      </p>
    </div>
    <div class="auk-form-group">
      <div class={{if this.isFullscreen 'auk-rdfa-holder auk-rdfa-fullscreen' 'auk-rdfa-holder'}}>
        <div class="auk-rdfa-holder__header auk-o-flex auk-o-flex--justify-between auk-o-flex--vertical-center">
          <AuLabel class="auk-u-p-0">
            {{t "decision-in-newsletter"}}
            <span class={{if this.isFullscreen '' 'au-u-hidden-visually'}}>  voor {{@newsletterInfo.title}}</span>
          </AuLabel>
          {{#if this.isFullscreen}}
            <AuButtonGroup>
              <AuButton
                @skin="naked"
                @icon="minimize"
                @iconAlignment="left"
                {{on "click" this.toggleFullscreen}}
              >
                {{t "close-fullscreen"}}
              </AuButton>
              <WebComponents::VlSaveButton
                data-test-newsletter-edit-item-save={{true}}
                @text={{t "save"}}
                @isLoading={{this.isLoading}}
                @saveAction={{this.trySaveChanges}}
              />
            </AuButtonGroup>
          {{else}}
            <AuButton
              @skin="naked"
              @icon="expand"
              @iconAlignment="left"
              {{on "click" this.toggleFullscreen}}
            >
              {{t "fullscreen"}}
            </AuButton>
          {{/if}}
        </div>
        <WebComponents::VlRdfaEditor
          data-test-newsletter-edit-item-rdfa-editor={{true}}
          @richtext={{await this.newsletterInfo.richtext}}
          @handleRdfaEditorInit={{this.handleRdfaEditorInit}}
        />
      </div>
    </div>
  </Auk::Panel::Body>
  <Auk::Panel::Body class="au-u-background-gray-100">
    <div class="auk-form-group auk-u-text-capitalize">
      <AuLabel>Opmerking</AuLabel>
      <AuInput
        data-test-newsletter-edit-item-remark
        @width="block"
        @value={{@newsletterInfo.remark}}
      />
    </div>
    <div class="auk-form-group">
      <AuLabel for="item-finished">{{t "finished"}}</AuLabel>
      <Auk::Toggle
        data-test-newsletter-edit-item-toggle-finished
        id="item-finished"
        @checked={{@newsletterInfo.finished}}
      />
    </div>
    <div class="auk-form-group" data-test-newsletter-edit-item-themes-selector>
      <AuLabel>{{t "themes"}}</AuLabel>
      <Utils::ThemesSelector @selectedThemes={{await @newsletterInfo.themes}} />
    </div>
  </Auk::Panel::Body>
  <Auk::Panel::Body class="au-u-background-gray-100">
    <Auk::Toolbar>
      <Auk::Toolbar::Group @position="right">
        <Auk::Toolbar::Item>
          <Auk::ButtonLink data-test-newsletter-edit-item-cancel {{on "click" this.cancelEditing}}>
            {{t "cancel"}}
          </Auk::ButtonLink>
        </Auk::Toolbar::Item>
        <Auk::Toolbar::Item>
          <WebComponents::VlSaveButton
            data-test-newsletter-edit-item-save={{true}}
            @text={{t "save"}}
            @isLoading={{this.isLoading}}
            @saveAction={{this.trySaveChanges}}
          />
        </Auk::Toolbar::Item>
      </Auk::Toolbar::Group>
    </Auk::Toolbar>
  </Auk::Panel::Body>
</Auk::Panel>

{{#if this.isTryingToSave}}
  <WebComponents::VlModalVerify
    @title={{t "no-themes-selected"}}
    @message={{t "no-themes-selected-message"}}
    @cancel={{set this "isTryingToSave" false}}
    @verify={{this.saveChanges}}
    @buttonText="save"
    @buttonType="warning"
    @showIcon={{false}}
  />
{{/if}}