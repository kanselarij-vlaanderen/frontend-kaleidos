<div class="auk-u-m-8">
  {{page-title (t "manage-ministers")}}
  <div class="auk-u-flex auk-u-flex--justify-between">
    <h4 class="auk-h3"></h4>
    <button data-test-minister-add
      type="button"
      class="auk-button auk-button--primary"
      {{action "toggleIsAdding"}}
    >
      <span class="auk-button__content">
        <div class="auk-icon auk-icon--default">
          <i class="ki ki-add"></i>
        </div>
        <div class="auk-button__label">
          {{t "create-mandatee"}}
        </div>
      </span>
    </button>
  </div>
  {{#if (await model)}}
  {{!-- "tbody" tagname in the "sortable-group"-helper --}}
  {{!-- template-lint-disable table-groups  --}}
    <table class="auk-table auk-table--striped">
      <thead>
        <tr>
          <th class="auk-table__col--6 auk-table__header-title">
            <a class="auk-table__header-title--sortable auk-table__header-title--sortable-active"
               href="#"
            ></a>
            <a class="auk-table__header-title--sortable" href="#">
              <div class="auk-u-flex auk-u-flex--vertical-center">
                <span>
                  {{t "minister"}}
                </span>
              </div>
            </a>
          </th>
          <th class="auk-table__col--3 auk-table__header-title">
            <a class="auk-table__header-title--sortable auk-table__header-title--sortable-active"
               href="#"
            ></a>
            <a class="auk-table__header-title--sortable" href="#">
              <div class="auk-u-flex auk-u-flex--vertical-center">
                <span>
                  {{t "nick-name"}}
                </span>
              </div>
            </a>
          </th>
          <th class="auk-table__col--1 auk-table__header-title">
            <a class="auk-table__header-title--sortable auk-table__header-title--sortable-active"
               href="#"
            ></a>
            <a class="auk-table__header-title--sortable" href="#">
              <div class="auk-u-flex auk-u-flex--vertical-center">
                <span>
                  {{t "priority"}}
                </span>
              </div>
            </a>
          </th>
          <th class="auk-table__col--2"></th>
        </tr>
      </thead>
      <SortableGroup
        data-test-ministers-sortable-group
        @tagName="tbody"
        @model={{model}}
        @onChange={{action "reorderItems" model}}
      as |sortableGroup|
      >
        {{#each sortableGroup.model as |mandatee index|}}
          <sortableGroup.item
            @tagName="tr"
            @model={{mandatee}}
            data-test-ministers-sortable-group-row="index"
            @handle=".mandatee-draggable-row"
          >
            <td data-test-mandatee-fullDisplayName={{index}} class="mandatee-draggable-row">
              {{#if (is-pending mandatee.fullDisplayName)}}
                <div class="skeletal-loader" role="alert" aria-busy="true"></div>
              {{else}}
                {{await mandatee.fullDisplayName}}
              {{/if}}
            </td>
            <td data-test-mandatee-nickName={{index}} class="mandatee-draggable-row">
              {{#if (is-pending mandatee.nickName)}}
                <div class="skeletal-loader" role="alert" aria-busy="true"></div>
              {{else}}
                {{await mandatee.nickName}}
              {{/if}}
            </td>
            <td data-test-mandatee-priority={{index}} class="mandatee-draggable-row">
              {{await mandatee.priority}}
            </td>
            <td class="auk-u-text-align--center">
              <WebComponents::AuToolbar>
                <WebComponents::AuToolbar::Group @position="center">
                  <WebComponents::AuToolbar::Item>
                    <button data-test-mandatee-edit={{index}}
                      type="button"
                      class="auk-button auk-button--borderless auk-button--icon"
                      {{action "toggleProperty" "isEditingMandatee" mandatee}}
                    >
                      <span class="auk-button__content">
                        <div class="auk-icon auk-icon--default">
                          <i class="ki ki-pencil"></i>
                        </div>
                      </span>
                    </button>
                  </WebComponents::AuToolbar::Item>
                  <WebComponents::AuToolbar::Item>
                    <button type="button"
                      data-test-mandatee-resign={{index}}
                      class="auk-button auk-button--borderless auk-button--icon"
                      {{action "toggleProperty" "isResigningMandatee" mandatee}}
                    >
                      <span class="auk-button__content">
                        <div class="auk-icon auk-icon--default">
                          <i class="ki ki-settings"></i>
                        </div>
                        <EmberTooltip @side="bottom" @tooltipClass="tooltip-custom">
                          {{t "resign"}}
                        </EmberTooltip>
                      </span>
                    </button>
                  </WebComponents::AuToolbar::Item>
                  <WebComponents::AuToolbar::Item>
                    <button type="button"
                      data-test-mandatee-delete={{index}}
                      class="auk-button auk-button--borderless auk-button--icon auk-u-text-error"
                      {{action "toggleProperty" "isDeletingMandatee" mandatee}}
                    >
                      <span class="auk-button__content">
                        <div class="auk-icon auk-icon--default">
                          <i class="ki ki-delete"></i>
                        </div>
                      </span>
                    </button>
                  </WebComponents::AuToolbar::Item>
                </WebComponents::AuToolbar::Group>
              </WebComponents::AuToolbar>
            </td>
          </sortableGroup.item>
        {{/each}}
      </SortableGroup>
    </table>
  {{!-- template-lint-enable table-groups --}}
  {{/if}}
  {{#if isEditingMandatee}}
    {{#web-components/vl-modal
      isOverlay=true
      title=(t "manage-ministers")
      closeModal=(action "toggleProperty" "isEditingMandatee" mandateeToEdit)
    }}
      {{utils/manage-mandatees
        mandateeToEdit=mandateeToEdit
        mandateesUpdated=(action "mandateesUpdated")
        isEditing=isEditingMandatee
        closeModal=(action "toggleProperty" "isEditingMandatee" mandateeToEdit)
      }}
    {{/web-components/vl-modal}}
  {{/if}}
  {{#if isResigningMandatee}}
    {{#web-components/vl-modal
      isOverlay=true
      title=(t "manage-ministers")
      closeModal=(action "toggleProperty" "isResigningMandatee" mandateeToEdit)
    }}
      {{utils/manage-mandatees
        mandateeToEdit=mandateeToEdit
        mandateesUpdated=(action "mandateesUpdated")
        isResigning=isResigningMandatee
        closeModal=(action "toggleProperty" "isResigningMandatee" mandateeToEdit)
      }}
    {{/web-components/vl-modal}}
  {{/if}}
  {{#if isAddingMandatee}}
    {{#web-components/vl-modal
      isOverlay=true
      title=(t "manage-ministers")
      closeModal=(action "toggleIsAdding")
    }}
      {{utils/create-mandatee
        model=model
        closeModal=(action "toggleIsAdding")
        mandateesUpdated=(action "mandateesUpdated")
      }}
    {{/web-components/vl-modal}}
  {{/if}}
  {{#if isDeletingMandatee}}
    {{web-components/vl-modal-verify
      title=(t "warning-title")
      verifyButtonText=(t "delete")
      message=(t "delete-mandatee-message")
      cancel=(action "cancel")
      verify=(action "deleteMandatee")
      mandateesUpdated=(action "mandateesUpdated")
    }}
  {{/if}}
  {{outlet}}
</div>