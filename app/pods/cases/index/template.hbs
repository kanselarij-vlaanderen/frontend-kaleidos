{{page-title (t "cases")}}
<Cases::CasesHeader @isAddingCase={{this.isAddingCase}} @close={{this.close}} />
<div class="auk-scroll-wrapper">
  <div class="auk-scroll-wrapper__body">
    <div class="auk-u-m-4">
      {{#if this.model.length}}
        <table class="auk-table auk-table--styled js-data-table">
          <thead>
            <tr>
              <th class="auk-u-text-nowrap" >
                {{t "case-name-2"}}
              </th>
              <Utils::ThSortable
                @onChange={{this.sortTable}}
                @currentSorting={{this.sort}}
                @field={{"on-agenda"}}
                @label={{t "latest-on-agenda"}}/>
              <Utils::ThSortable
                @onChange={{this.sortTable}}
                @currentSorting={{this.sort}}
                @field={{"created"}}
                @label={{t "created-on"}}/>
              <th>&nbsp;</th>
            </tr>
          </thead>
          <tbody>
            {{#each this.model as |case|}}
              <tr>
                <td>
                  {{case.shortTitle}}
                </td>
                <td>
                  {{moment-format case.created "DD-MM-YYYY HH:mm"}}
                </td>
                <td>
                  {{moment-format case.created "DD-MM-YYYY HH:mm"}}
                </td>
                <td>
                  <div class="auk-button-toolbar">
                    {{#if this.currentSession.isEditor}}
                      <button type="button"
                        class="auk-button auk-button--borderless auk-button--icon">
                        <span class="auk-button__content">
                          <div class="auk-icon auk-icon--default auk-icon--more">
                            <i class="ki ki-more"></i>
                          </div>  
                        </span>
                        <AttachPopover
                          @renderInPlace={{true}}
                          @class="ember-attacher-popper"
                          @hideOn="clickout click"
                          @showOn="click"
                          @animation="shift"
                          @placement="bottom-end"
                          as |attacher|
                        >
                          <ul class="auk-menu auk-menu--visible">
                            <li>
                              <a href="" class="auk-menu__item"
                                {{action attacher.hide}}
                                {{action "editCase" case}}
                              >
                                {{t "edit-2"}}
                              </a>
                            </li>
                            <li>
                              {{#if (not case.isArchived)}}
                                <a href="" class="auk-menu__item auk-menu__item--danger"
                                  {{action attacher.hide}}
                                  {{action "requestArchiveCase" case}}
                                >
                                  {{t "delete"}}
                                </a>
                              {{else}}
                                <a href="" class="auk-menu-item auk-menu__item--danger"
                                  {{action attacher.hide}}
                                  {{action "unarchiveCase" case}}
                                >
                                  {{t "unarchive"}}
                                </a>
                              {{/if}}
                            </li>
                          </ul>
                        </AttachPopover>
                      </button>
                    {{/if}}
                    <LinkTo @route="cases.case.subcases" @model={{case.id}} class="auk-button auk-button--borderless auk-button--icon">
                      <span class="auk-button__content">
                        <div class="auk-icon auk-icon--default">
                          <i class="ki ki-nav-right"></i>
                        </div>
                      </span>
                    </LinkTo>
                  </div>
                </td>
              </tr>
            {{/each}}
          </tbody>
        </table>
      {{/if}}
    </div>
  </div>
</div>
<div>
  <hr>
</div>
<div class="auk-u-mx-4">
  <WebComponents::AuToolbar>
    <WebComponents::AuToolbar::Group @position="left">
      <WebComponents::AuToolbar::Item>
        <Auk::Pagination
          @page={{this.page}}
          @size={{this.size}}
          @nbOfItems={{this.model.length}}
          @total={{this.model.meta.count}}
          @onNextPage={{this.nextPage}}
          @onPreviousPage={{this.prevPage}}
        />
      </WebComponents::AuToolbar::Item>
    </WebComponents::AuToolbar::Group>
    <WebComponents::AuToolbar::Group @position="right">
      <WebComponents::AuToolbar::Item>
        <Auk::Button
          @icon="settings"
          @skin="borderless"
          data-test-publication-button-filter-tables
          {{on "click" this.toggleColumnDisplayOptions}}
        />
        {{!-- <AttachPopover
                @class="auk-popover"
                @showOn="click"
                @placement="top"
                @hideOn="click"
                @isShown={{this.showTableDisplayOptions}}
                @renderInPlace={{false}}
        >
          <Publications::OverviewTableDisplayConfigModal
                  @options={{this.tableColumnDisplayOptions}}
                  @onChange={{this.changeColumnDisplayOptions}}
                  @onClose={{this.toggleColumnDisplayOptions}}
          />
        </AttachPopover> --}}
      </WebComponents::AuToolbar::Item>
      <WebComponents::AuToolbar::Item>
        {{t "amount-showed"}}
      </WebComponents::AuToolbar::Item>
      <WebComponents::AuToolbar::Item>
        <WebComponents::AuPageSize
          @selectedSize={{this.size}}
          @sizeOptions={{this.sizeOptions}}
          @onChange={{this.setSizeOption}}
        >
        </WebComponents::AuPageSize>
      </WebComponents::AuToolbar::Item>
    </WebComponents::AuToolbar::Group>
  </WebComponents::AuToolbar>
</div>